generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// prisma repo generator
generator repo {
  provider = "prisma-repo"
  output   = "../src/repository"
  query    = true
  warn     = true
  info     = true
  error    = true
}

model Categoria {
  id        Int      @id @default(autoincrement())
  tipo      String
  titulo    String   @unique
  descricao String?
  insumos   Insumo[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("Categorias")
}

model Insumo{
  id            Int        @id @default(autoincrement())
  titulo        String
  descricao     String?
  unidadeMedida String?
  idCategoria   Int?
  categoria     Categoria? @relation(fields: [idCategoria], references: [id])
  listaInsumo   ListaInsumo[]
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt

  @@map("Insumos")
}

model Fornecedor{
  id      Int @id @default(autoincrement())
  email   String @unique
  telefone String
  contaTipo contaTipo
  rua       String?
  numero    String?
  complemento String?
  cep         String?
  bairro      String?
  cidade      String?
  estado      String?
  pais        String?
  Nome        String?
  cpf         String? @unique
  rg          String? @unique
  nomeFantasia String?
  razaoSocial String? @unique
  cnpj        String? @unique
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt
  
  @@map("Fornecedores")
}

model Cliente{
  id      Int @id @default(autoincrement())
  email   String @unique
  telefone String
  contaTipo contaTipo
  rua       String?
  numero    String?
  complemento String?
  cep         String?
  bairro      String?
  cidade      String?
  estado      String?
  pais        String?
  Nome        String?
  cpf         String? @unique
  rg          String? @unique
  nomeFantasia String?
  razaoSocial String? @unique
  cnpj        String? @unique
  orcamentos  Orcamento[]
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt
  
  @@map("Clientes")
}
model Orcamento{
  id      Int @id @default(autoincrement())
  validade DateTime?
  dataOrcamento DateTime  @default(now())
  totalMaoObra Float?
  totalMateriais Float?
  valorPago Float?
  status   status @default(Pendente)
  prazoEstimadoProducao Int?
  observacoes String? @db.MediumText
  idCliente Int
  cliente Cliente? @relation(fields: [idCliente], references: [id])
  pedidos Pedido[]
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt

  @@map("Orcamentos")
}

model Pedido{
  id Int @id @default(autoincrement())
  pagamento Float
  status status?
  idOrcamento Int
  orcamento Orcamento? @relation(fields: [idOrcamento], references: [id])

  @@map("Pedidos")
}

model Produto{
  id Int @id @default(autoincrement())
  titulo String
  quantidade Int?
  valorUnitario Float?
  tipo produtoTipo
  listaInsumos ListaInsumo[]
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt

  @@map("Produtos")
}

model Cotacao{
  id Int @id @default(autoincrement())
  data DateTime
  valor Float?
  listaInsumos ListaInsumo[]
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt
}

model ListaInsumo{
  id Int @id @default(autoincrement())
  quantidade Int?
  idProduto Int?
  idInsumo Int?
  idCotacao Int?
  produto Produto? @relation(fields: [idProduto], references: [id])
  insumo Insumo? @relation(fields: [idInsumo], references: [id])
  cotacao Cotacao? @relation(fields: [idCotacao],references: [id])
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt

  @@map("ListaInsumos")
}

enum contaTipo {
  Fisico
  Juridico
}
enum produtoTipo {
  Base
  Customizado
}

enum status {
  Pendente
  Iniciado
  Em_Processo @map("Em Processo")
  Concluido
}
